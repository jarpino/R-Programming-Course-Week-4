{
    "contents" : "best <- function(state, outcome) {\n  ## get data by the outcome, will test for valid outcome\n  \n  dt <- getDataByOutcome(outcome)\n  \n  names(dt)[3] <- \"rate\"\n  \n  ## get the data for the state that you want\n  ## function will retun ordered dataset\n  ## and stop on an invalid state\n  dt <- getDataByState(dt, state)\n  \n  topValue <- dt[[1,3]]\n  \n  dt <- subset(dt, dt[,3] == topValue)\n  \n  dt <- dt[order(dt[,2]), ]\n  \n  ## Return hospital name in that state with lowest 30-day death\n  ## rate\n  as.character(as.vector(dt[1,2]))\n  \n}\n\nworst <- function(state, outcome) {\n  ## get data by the outcome, will test for valid outcome\n  \n  dt <- getDataByOutcome(outcome)\n  \n  names(dt)[3] <- \"rate\"\n  \n  ## get the data for the state that you want\n  ## function will retun ordered dataset\n  ## and stop on an invalid state\n  dt <- getDataByState(dt, state)\n  \n  rows <- nrow(dt)\n  \n  bottomValue <- dt[[rows,3]]\n  \n  dt <- subset(dt, dt[,3] == bottomValue)\n  \n  dt <- dt[order(dt[,2]), ]\n  \n  ## Return hospital name in that state with lowest 30-day death\n  ## rate\n  as.character(as.vector(dt[1,2]))\n  \n}\n\ngetDataByOutcome <- function(outcome) {\n  ## Read data from csv file\n  dataTable <- read.csv(\"data/outcome-of-care-measures.csv\", colClasses = \"character\");\n  \n  # - hospital name column\n  hospitalColName <- colnames(dataTable[2])\n  \n  # - state column (useful for rankall function)\n  stateColName <- colnames(dataTable[7])\n  \n  # - death rate column based on outcome\n  \n  if (outcome == 'heart attack'){\n    dataColName <- colnames(dataTable[11])\n  }\n  else if (outcome == 'heart failure') {\n    dataColName <- colnames(dataTable[17])\n  }\n  else if (outcome == 'pneumonia') {\n    dataColName <- colnames(dataTable[23])\n  }\n  else {\n    stop(\"invalid outcome\")\n  }\n  \n  # filter data containing 3 columns:\n  columns <- c(stateColName,hospitalColName,dataColName)\n  \n  # re-assign data frame with only 3 columns\n  reducedTable <- dataTable[columns]\n  \n  # convert death rate (column 3) to numeric\n  \n  reducedTable[, 3] <- suppressWarnings(as.numeric(as.vector(reducedTable[, 3])))\n  \n  # remove rows with NAs in column 2\n  reducedTable <- reducedTable[complete.cases(reducedTable),]\n  \n  # stop on invalid state - no rows in data\n  \n  if (nrow(reducedTable) < 1) {\n    stop(\"no rows returned\")\n  }\n\n  # return data\n  reducedTable\n  \n}\n\ngetDataByState <- function(data, state) {\n  # filter by state\n  data <- subset(data, State == state)\n  \n  # remove rows with NAs\n  data <- data[complete.cases(data),]\n  \n  # stop on invalid state - no rows in data\n  if (nrow(data) < 1) {\n    stop(\"invalid state\")\n  }\n  \n  # sort on column 3 (death rate) to have lowest value on top\n  data <- data[order(data[,3]), ]\n  \n  ## Return all data based on state and outcome\n  data\n  \n}\n\nrankhospital <- function(state, outcome, num = \"best\") {\n  \n  # if num is numeric then get the data value\n  if (typeof(num) == 'integer'| typeof(num) == 'double'){\n    # if num within data rows...\n    # Read data and filter by outcome\n    data <- getDataByOutcome(outcome)\n    \n    # filter again by state\n    data <- getDataByState(data, state)\n    \n    # filter finally based on ranking/num\n    hospital <- getRanking(data, num)\n    \n    ## Return hospital name in that state with the given rank\n    ## 30-day death rate\n    return(hospital)\n  } \n  # if num is worst then...\n  else if (num == \"worst\"){\n    return(worst(state, outcome))\n    \n  }\n  # if num is 'best' then get data from first row\n  else if (num == \"best\") {\n    \n    return(best(state, outcome))\n    \n  }\n  # else stop with message 'invalid num'\n  else {\n    stop(\"invalid num\")\n  }\n  \n}\n\ngetRanking <- function(data, num = \"best\") {\n  \n  rows <- nrow(data)\n  \n  # in row=??? and column=2 (death rate)\n  if (num <= rows){\n    \n    # sort hospital names (column 1) in alphabetical order\n    data <- data[order(data[,3]), ]\n    \n    topValue <- data[[num,3]]\n    \n    # filter by death rate\n    data <- subset(data, data[,3] == topValue)\n    \n    ##data <- data[order(data[,2]), ]\n    \n    ## Return hospital name in that state\n    \n    return(as.character(as.vector(data[1,2])))\n    \n  }\n  else {\n    # else num is greater/outside data rows\n    return(NA)\n  }\n \n}\n",
    "created" : 1427413098763.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4072001954",
    "id" : "449FD09A",
    "lastKnownWriteTime" : 1427569644,
    "path" : "~/R Studio/R-Programming-Course-Week-4/best.R",
    "project_path" : "best.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}